<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <title>房源信息</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" th:href="@{/lib/layui/css/layui.css}"  media="all">
    <link rel="stylesheet" th:href="@{/css/font-awesome.min.css}">
    <link rel="stylesheet" th:href="@{/lib/layui/css/layui.css}" media="all">
    <link rel="stylesheet" th:href="@{/lib/admin/admin.css}" media="all">
    <link rel="stylesheet" th:href="@{/lib/Scrollbar/jquery.scrollbar.css}">
    <script type="text/javascript" th:src="@{/lib/admin/jquery-1.9.1.min.js}"></script>
    <script type="text/javascript" th:src="@{/lib/Scrollbar/jquery.scrollBar.js}"></script>
    <script type="text/javascript" th:src="@{/lib/layui/layui.js}"></script>
    <script type="text/javascript" th:src="@{/lib/admin/admin.js}"></script>
</head>
<body class="layui-body-content">
<div class="layui-layout layui-layout-admin">
    <div th:replace="~{index::topbar}"></div>
</div>
<div class="layui-layout">
    <table class="layui-hide" id="test" lay-filter="test" ></table>
</div>

<script type="text/html" id="toolbarDemo">

    <button class="layui-btn layui-btn-sm" lay-event="getCheckData">获取选中行数据</button>
    <button class="layui-btn layui-btn-sm" lay-event="getCheckLength">获取选中数目</button>
    <button class="layui-btn layui-btn-sm" lay-event="isAll">验证是否全选</button>
    <div  class="layui-inline" style="float:right;height:29px;">
        <form class="demoTable" action="/search">
            <input class="layui-input" name="param" id="demoReload" value="" type="text"  style="width:200px;float:left;height:30px;" placeholder="请输入查询" autocomplete="off" />
            <button class="layui-btn" data-type="reload" id="search">搜索</button>
        </form>
    </div>
</script>


<script type="text/html" id="barDemo">
    <a th:href="@{/templates/updateHousePage.html}" class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
    <a th:href="@{/templates/deleteHousePage.html}" class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
</script>

<script th:src="@{/lib/layui/layui.js}" charset="utf-8"></script>
<script>
    layui.use('table', function(){
        var table = layui.table;
        table.render({
            elem: '#test'
            ,url:'http://localhost:8080/jsonHouse'
            ,toolbar: '#toolbarDemo'
            ,width: '100%'
            ,height: '960px'
            ,title: '租房信息'
            ,cols: [
                [
                    {type: "checkbox", width: 50},
                    {field: 'id', width: 70, title: 'ID', sort: true},
                    {field: 'hostName', width: 80, title: '用户名'},
                    {field: 'address', width: 130, title: '房东住址', sort: true},
                    {field: 'houseResource', width: 100, title: '房型', sort: true},
                    {field: 'houseType', width: 130, title: '户型',sort: true},
                    {field: 'addressName', width: 100, title: '房屋区域', sort: true},
                    {field: 'price', width: 100, title: '价格', sort: true},
                    {field: 'area', width: 100, title: '房屋面积', sort: true},
                    {field: 'tel', title: '房东电话', minWidth: 120},
                    {field: 'content', width: 200, title: '备注', sort: true},
                    {field: 'releaseTime', width: 150, title: '发布时间', sort: true,templet :function (row){
                            return releaseTime(row.releaseTime);
                        }},
                    {title: '操作', minWidth: 150, toolbar: '#barDemo', align: "center"}
                ]
            ]
            ,id: 'testReload'
            ,page: true
        });
        var $ = layui.$, active = {
            reload: function(){
                var demoReload = $('#demoReload');
                console.log(demoReload.val())
                //执行重载
                table.reload('testReload', {

                    page: {
                        curr: 1 //重新从第 1 页开始
                    }
                    ,where: {
                            key: {
                                id: demoReload.val()
                            }
                    }
                }, 'data');
            }
        };
        $('#search').on('click', function(){
            var type = $(this).data('type');
            active[type] ? active[type].call(this) : '';
        });


        //工具栏事件
        table.on('toolbar(test)', function(obj){
            var checkStatus = table.checkStatus(obj.config.id);
            var value = table.checkStatus(obj.id)
            switch(obj.event){
                case 'getCheckData':
                    var data = checkStatus.data;
                    layer.alert(JSON.stringify(data));
                    break;
                case 'getCheckLength':
                    var data = checkStatus.data;
                    layer.msg('选中了：'+ data.length + ' 个');
                    break;
                case 'isAll':
                    layer.msg(checkStatus.isAll ? '全选': '未全选')
                    break;
            };
        });

    });
</script>
<script>
    function cleancache(){
        var a = hg.load(function(){
            var that = this;
            setTimeout(function(){
                //that.close(); //关闭加载层
                a.close();
                hg.msghide('清除服务器缓存成功.');
            },2000);
        })
    }
</script>
<script type="text/javascript" th:src="@{/lib/admin/jquery-1.9.1.min.js}"></script>
<script type="text/javascript" th:src="@{/lib/Scrollbar/jquery.scrollBar.js}"></script>
<script type="text/javascript">
    function releaseTime (v){
        var date = new Date(v);
        var y = date.getFullYear();
        var m = date.getMonth()+1;
        m = m<10?'0'+m:m;
        var d = date.getDate();
        d = d<10?("0"+d):d;
        var h = date.getHours();
        h = h<10?("0"+h):h;
        var M = date.getMinutes();
        M = M<10?("0"+M):M;
        var str = y+"-"+m+"-"+d+" "+h+":"+M;
        return str;}
</script>


</body>
</html>